<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>API Reference &#8212; OpenManus 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=01f34227"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorials" href="tutorials.html" />
    <link rel="prev" title="Sandbox System" href="sandbox_system.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#core-data-models-app-schema-py" id="id1">Core Data Models (<code class="docutils literal notranslate"><span class="pre">app/schema.py</span></code>)</a></p>
<ul>
<li><p><a class="reference internal" href="#enums" id="id2">Enums</a></p></li>
<li><p><a class="reference internal" href="#message" id="id3">Message</a></p></li>
<li><p><a class="reference internal" href="#toolcall" id="id4">ToolCall</a></p></li>
<li><p><a class="reference internal" href="#memory" id="id5">Memory</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#agent-api-app-agent" id="id6">Agent API (<code class="docutils literal notranslate"><span class="pre">app/agent/</span></code>)</a></p>
<ul>
<li><p><a class="reference internal" href="#baseagent" id="id7">BaseAgent</a></p></li>
<li><p><a class="reference internal" href="#reactagent" id="id8">ReActAgent</a></p></li>
<li><p><a class="reference internal" href="#toolcallagent" id="id9">ToolCallAgent</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#tool-api-app-tool" id="id10">Tool API (<code class="docutils literal notranslate"><span class="pre">app/tool/</span></code>)</a></p>
<ul>
<li><p><a class="reference internal" href="#basetool" id="id11">BaseTool</a></p></li>
<li><p><a class="reference internal" href="#toolresult" id="id12">ToolResult</a></p></li>
<li><p><a class="reference internal" href="#toolcollection" id="id13">ToolCollection</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#flow-api-app-flow" id="id14">Flow API (<code class="docutils literal notranslate"><span class="pre">app/flow/</span></code>)</a></p>
<ul>
<li><p><a class="reference internal" href="#baseflow" id="id15">BaseFlow</a></p></li>
<li><p><a class="reference internal" href="#planningflow" id="id16">PlanningFlow</a></p></li>
<li><p><a class="reference internal" href="#flowfactory" id="id17">FlowFactory</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#llm-api-app-llm-py" id="id18">LLM API (<code class="docutils literal notranslate"><span class="pre">app/llm.py</span></code>)</a></p></li>
<li><p><a class="reference internal" href="#configuration-api-app-config-py" id="id19">Configuration API (<code class="docutils literal notranslate"><span class="pre">app/config.py</span></code>)</a></p></li>
<li><p><a class="reference internal" href="#exception-classes-app-exceptions-py" id="id20">Exception Classes (<code class="docutils literal notranslate"><span class="pre">app/exceptions.py</span></code>)</a></p></li>
<li><p><a class="reference internal" href="#mcp-api" id="id21">MCP API</a></p>
<ul>
<li><p><a class="reference internal" href="#client-app-tool-mcp-py" id="id22">Client (<code class="docutils literal notranslate"><span class="pre">app/tool/mcp.py</span></code>)</a></p></li>
<li><p><a class="reference internal" href="#server-app-mcp-server-py" id="id23">Server (<code class="docutils literal notranslate"><span class="pre">app/mcp/server.py</span></code>)</a></p></li>
</ul>
</li>
</ul>
</nav>
<p>This document provides technical API specifications for all OpenManus
modules, intended for developers extending or integrating with the
framework.</p>
<section id="core-data-models-app-schema-py">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Core Data Models (<code class="docutils literal notranslate"><span class="pre">app/schema.py</span></code>)</a><a class="headerlink" href="#core-data-models-app-schema-py" title="Link to this heading">¶</a></h2>
<section id="enums">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">Enums</a><a class="headerlink" href="#enums" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Role</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
    <span class="n">SYSTEM</span> <span class="o">=</span> <span class="s2">&quot;system&quot;</span>
    <span class="n">USER</span> <span class="o">=</span> <span class="s2">&quot;user&quot;</span>
    <span class="n">ASSISTANT</span> <span class="o">=</span> <span class="s2">&quot;assistant&quot;</span>
    <span class="n">TOOL</span> <span class="o">=</span> <span class="s2">&quot;tool&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ToolChoice</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
    <span class="n">NONE</span> <span class="o">=</span> <span class="s2">&quot;none&quot;</span>       <span class="c1"># LLM must not call tools</span>
    <span class="n">AUTO</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span>       <span class="c1"># LLM decides whether to call tools</span>
    <span class="n">REQUIRED</span> <span class="o">=</span> <span class="s2">&quot;required&quot;</span>  <span class="c1"># LLM must call at least one tool</span>

<span class="k">class</span><span class="w"> </span><span class="nc">AgentState</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
    <span class="n">IDLE</span> <span class="o">=</span> <span class="s2">&quot;IDLE&quot;</span>
    <span class="n">RUNNING</span> <span class="o">=</span> <span class="s2">&quot;RUNNING&quot;</span>
    <span class="n">FINISHED</span> <span class="o">=</span> <span class="s2">&quot;FINISHED&quot;</span>
    <span class="n">ERROR</span> <span class="o">=</span> <span class="s2">&quot;ERROR&quot;</span>
</pre></div>
</div>
</section>
<section id="message">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Message</a><a class="headerlink" href="#message" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Message</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">role</span><span class="p">:</span> <span class="n">Role</span>
    <span class="n">content</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">tool_calls</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">ToolCall</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">tool_call_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">base64_image</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Factory methods</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">user_message</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Message&quot;</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">assistant_message</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Message&quot;</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">system_message</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Message&quot;</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">tool_message</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span>
        <span class="n">tool_call_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">base64_image</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;Message&quot;</span>

    <span class="c1"># Conversion</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>  <span class="c1"># OpenAI API format</span>
</pre></div>
</div>
</section>
<section id="toolcall">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">ToolCall</a><a class="headerlink" href="#toolcall" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ToolCall</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nb">id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="nb">type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;function&quot;</span>
    <span class="n">function</span><span class="p">:</span> <span class="n">Function</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Function</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">arguments</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># JSON-encoded string</span>
</pre></div>
</div>
</section>
<section id="memory">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Memory</a><a class="headerlink" href="#memory" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Memory</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Message</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">max_messages</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Message</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Message</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">clear</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_recent_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Message</span><span class="p">]</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_dict_list</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="agent-api-app-agent">
<h2><a class="toc-backref" href="#id6" role="doc-backlink">Agent API (<code class="docutils literal notranslate"><span class="pre">app/agent/</span></code>)</a><a class="headerlink" href="#agent-api-app-agent" title="Link to this heading">¶</a></h2>
<section id="baseagent">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">BaseAgent</a><a class="headerlink" href="#baseagent" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BaseAgent</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
    <span class="c1"># Configuration</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;base&quot;</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">system_prompt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">next_step_prompt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">duplicate_threshold</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="c1"># State</span>
    <span class="n">memory</span><span class="p">:</span> <span class="n">Memory</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">Memory</span><span class="p">)</span>
    <span class="n">state</span><span class="p">:</span> <span class="n">AgentState</span> <span class="o">=</span> <span class="n">AgentState</span><span class="o">.</span><span class="n">IDLE</span>
    <span class="n">current_step</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">llm</span><span class="p">:</span> <span class="n">LLM</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">LLM</span><span class="p">)</span>

    <span class="c1"># Methods</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_memory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">role</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">content</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_stuck</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</pre></div>
</div>
</section>
<section id="reactagent">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">ReActAgent</a><a class="headerlink" href="#reactagent" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ReActAgent</span><span class="p">(</span><span class="n">BaseAgent</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">think</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">act</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>  <span class="c1"># think() then act()</span>
</pre></div>
</div>
</section>
<section id="toolcallagent">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">ToolCallAgent</a><a class="headerlink" href="#toolcallagent" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ToolCallAgent</span><span class="p">(</span><span class="n">ReActAgent</span><span class="p">):</span>
    <span class="n">available_tools</span><span class="p">:</span> <span class="n">ToolCollection</span>
    <span class="n">tool_calls</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">ToolCall</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tool_choices</span><span class="p">:</span> <span class="n">ToolChoice</span> <span class="o">=</span> <span class="n">ToolChoice</span><span class="o">.</span><span class="n">AUTO</span>
    <span class="n">special_tool_names</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;terminate&quot;</span><span class="p">]</span>
    <span class="n">max_steps</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">max_observe</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">think</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">act</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="n">ToolCall</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">cleanup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</pre></div>
</div>
</section>
</section>
<section id="tool-api-app-tool">
<h2><a class="toc-backref" href="#id10" role="doc-backlink">Tool API (<code class="docutils literal notranslate"><span class="pre">app/tool/</span></code>)</a><a class="headerlink" href="#tool-api-app-tool" title="Link to this heading">¶</a></h2>
<section id="basetool">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">BaseTool</a><a class="headerlink" href="#basetool" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BaseTool</span><span class="p">(</span><span class="n">ABC</span><span class="p">,</span> <span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_param</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span>     <span class="c1"># OpenAI function format</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>   <span class="c1"># Delegates to execute()</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">success_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fail_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span>
</pre></div>
</div>
</section>
<section id="toolresult">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">ToolResult</a><a class="headerlink" href="#toolresult" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ToolResult</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">error</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">base64_image</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">system</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span>  <span class="c1"># True if output or error</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="s2">&quot;ToolResult&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ToolResult&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">replace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ToolResult&quot;</span>
</pre></div>
</div>
</section>
<section id="toolcollection">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">ToolCollection</a><a class="headerlink" href="#toolcollection" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ToolCollection</span><span class="p">:</span>
    <span class="n">tools</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">BaseTool</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>
    <span class="n">tool_map</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BaseTool</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">tools</span><span class="p">:</span> <span class="n">BaseTool</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">to_params</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">tool_input</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">BaseTool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">tools</span><span class="p">:</span> <span class="n">BaseTool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaseTool</span><span class="p">]</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_all</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">ToolResult</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="flow-api-app-flow">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Flow API (<code class="docutils literal notranslate"><span class="pre">app/flow/</span></code>)</a><a class="headerlink" href="#flow-api-app-flow" title="Link to this heading">¶</a></h2>
<section id="baseflow">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">BaseFlow</a><a class="headerlink" href="#baseflow" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">BaseFlow</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
    <span class="n">agents</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">BaseAgent</span><span class="p">]</span>
    <span class="n">tools</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">primary_agent_key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaseAgent</span><span class="p">]</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">primary_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BaseAgent</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="planningflow">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">PlanningFlow</a><a class="headerlink" href="#planningflow" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">PlanningFlow</span><span class="p">(</span><span class="n">BaseFlow</span><span class="p">):</span>
    <span class="n">planning_tool</span><span class="p">:</span> <span class="n">PlanningTool</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="n">PlanningTool</span>
    <span class="p">)</span>
    <span class="n">active_plan_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_create_initial_plan</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">_execute_step</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">executor</span><span class="p">:</span> <span class="n">BaseAgent</span><span class="p">,</span> <span class="n">step_info</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_executor</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">step_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseAgent</span>
</pre></div>
</div>
</section>
<section id="flowfactory">
<h3><a class="toc-backref" href="#id17" role="doc-backlink">FlowFactory</a><a class="headerlink" href="#flowfactory" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">FlowType</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
    <span class="n">PLANNING</span> <span class="o">=</span> <span class="s2">&quot;planning&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">FlowFactory</span><span class="p">:</span>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">create_flow</span><span class="p">(</span>
        <span class="n">flow_type</span><span class="p">:</span> <span class="n">FlowType</span> <span class="o">=</span> <span class="n">FlowType</span><span class="o">.</span><span class="n">PLANNING</span><span class="p">,</span>
        <span class="n">agents</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BaseFlow</span>
</pre></div>
</div>
</section>
</section>
<section id="llm-api-app-llm-py">
<h2><a class="toc-backref" href="#id18" role="doc-backlink">LLM API (<code class="docutils literal notranslate"><span class="pre">app/llm.py</span></code>)</a><a class="headerlink" href="#llm-api-app-llm-py" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">LLM</span><span class="p">:</span>
    <span class="n">_instances</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;LLM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_instance</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;LLM&quot;</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ask</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
        <span class="n">system_msgs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stream</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">temperature</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ask_with_images</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
        <span class="n">images</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">system_msgs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">ask_tool</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">],</span>
        <span class="n">system_msgs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tools</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">tool_choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
        <span class="n">temperature</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ChatCompletionMessage</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_messages</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">messages</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Message</span><span class="p">],</span>
        <span class="n">system_msgs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="configuration-api-app-config-py">
<h2><a class="toc-backref" href="#id19" role="doc-backlink">Configuration API (<code class="docutils literal notranslate"><span class="pre">app/config.py</span></code>)</a><a class="headerlink" href="#configuration-api-app-config-py" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Config</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Singleton configuration manager.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">llm</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">LLMSettings</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">browser_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">BrowserSettings</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">search_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SearchSettings</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sandbox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SandboxSettings</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">mcp_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">MCPSettings</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">run_flow_config</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RunflowSettings</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">daytona</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DaytonaSettings</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">workspace_root</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">root_path</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Path</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LLMSettings</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">base_url</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">api_key</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">max_tokens</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4096</span>
    <span class="n">max_input_tokens</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">api_type</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">api_version</span><span class="p">:</span> <span class="nb">str</span>

<span class="k">class</span><span class="w"> </span><span class="nc">BrowserSettings</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">headless</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">disable_security</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">extra_chromium_args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">proxy</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ProxySettings</span><span class="p">]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SearchSettings</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">engine</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">fallback_engines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">retry_delay</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">max_retries</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">lang</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">country</span><span class="p">:</span> <span class="nb">str</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SandboxSettings</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">use_sandbox</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">image</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">work_dir</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">memory_limit</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">cpu_limit</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">network_enabled</span><span class="p">:</span> <span class="nb">bool</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MCPSettings</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">server_reference</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">servers</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">MCPServerConfig</span><span class="p">]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">DaytonaSettings</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">daytona_api_key</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">daytona_server_url</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">daytona_target</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">sandbox_image_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">sandbox_entrypoint</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">VNC_password</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RunflowSettings</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">use_data_analysis_agent</span><span class="p">:</span> <span class="nb">bool</span>
</pre></div>
</div>
</section>
<section id="exception-classes-app-exceptions-py">
<h2><a class="toc-backref" href="#id20" role="doc-backlink">Exception Classes (<code class="docutils literal notranslate"><span class="pre">app/exceptions.py</span></code>)</a><a class="headerlink" href="#exception-classes-app-exceptions-py" title="Link to this heading">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">ToolError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when a tool encounters an error.&quot;&quot;&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">OpenManusError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Base exception for OpenManus.&quot;&quot;&quot;</span>

<span class="k">class</span><span class="w"> </span><span class="nc">TokenLimitExceeded</span><span class="p">(</span><span class="n">OpenManusError</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raised when token limit is exceeded.&quot;&quot;&quot;</span>
</pre></div>
</div>
</section>
<section id="mcp-api">
<h2><a class="toc-backref" href="#id21" role="doc-backlink">MCP API</a><a class="headerlink" href="#mcp-api" title="Link to this heading">¶</a></h2>
<section id="client-app-tool-mcp-py">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Client (<code class="docutils literal notranslate"><span class="pre">app/tool/mcp.py</span></code>)</a><a class="headerlink" href="#client-app-tool-mcp-py" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MCPClientTool</span><span class="p">(</span><span class="n">BaseTool</span><span class="p">):</span>
    <span class="n">session</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ClientSession</span><span class="p">]</span>
    <span class="n">server_id</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">original_name</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ToolResult</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MCPClients</span><span class="p">(</span><span class="n">ToolCollection</span><span class="p">):</span>
    <span class="n">sessions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ClientSession</span><span class="p">]</span>
    <span class="n">exit_stacks</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">AsyncExitStack</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">connect_sse</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">server_url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">server_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">connect_stdio</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">command</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">server_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">list_tools</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ListToolsResult</span>
</pre></div>
</div>
</section>
<section id="server-app-mcp-server-py">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Server (<code class="docutils literal notranslate"><span class="pre">app/mcp/server.py</span></code>)</a><a class="headerlink" href="#server-app-mcp-server-py" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MCPServer</span><span class="p">:</span>
    <span class="n">server</span><span class="p">:</span> <span class="n">FastMCP</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;openmanus&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">register_tool</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tool</span><span class="p">:</span> <span class="n">BaseTool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transport</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;stdio&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>

<span class="k">def</span><span class="w"> </span><span class="nf">parse_args</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">argparse</span><span class="o">.</span><span class="n">Namespace</span>
</pre></div>
</div>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">OpenManus</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">System Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="agent_system.html">Agent System</a></li>
<li class="toctree-l1"><a class="reference internal" href="orchestration_flow.html">Orchestration Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="tool_system.html">Tool System</a></li>
<li class="toctree-l1"><a class="reference internal" href="knowledge_and_skills.html">Knowledge and Skills System</a></li>
<li class="toctree-l1"><a class="reference internal" href="llm_integration.html">LLM Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="mcp_integration.html">MCP Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="sandbox_system.html">Sandbox System</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#core-data-models-app-schema-py">Core Data Models (<code class="docutils literal notranslate"><span class="pre">app/schema.py</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#agent-api-app-agent">Agent API (<code class="docutils literal notranslate"><span class="pre">app/agent/</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tool-api-app-tool">Tool API (<code class="docutils literal notranslate"><span class="pre">app/tool/</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#flow-api-app-flow">Flow API (<code class="docutils literal notranslate"><span class="pre">app/flow/</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#llm-api-app-llm-py">LLM API (<code class="docutils literal notranslate"><span class="pre">app/llm.py</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration-api-app-config-py">Configuration API (<code class="docutils literal notranslate"><span class="pre">app/config.py</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#exception-classes-app-exceptions-py">Exception Classes (<code class="docutils literal notranslate"><span class="pre">app/exceptions.py</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mcp-api">MCP API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="sandbox_system.html" title="previous chapter">Sandbox System</a></li>
      <li>Next: <a href="tutorials.html" title="next chapter">Tutorials</a></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, FoundationAgents.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/api_reference.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>